# baseline pretrained models load and evaluate
# compare each pretrained model to finetuned version of that model
#TODO: change line 71 test range
#TODO: change paths to models / checkpoints after retraining

import evaluate
from datasets import load_dataset
import torch
from transformers import AutoTokenizer, AutoModelForSeq2SeqLM
from pathlib import Path


def evaluate_model(model_path, test_dataset, metric_names=["rouge", "bertscore"]):
    model_path = Path(model_path).resolve()

    model = AutoModelForSeq2SeqLM.from_pretrained(model_path, local_files_only=True)

    device = torch.device("cuda" if torch.cuda.is_available() else "cpu")
    model.to(device)
    print(f"Loaded model from {model_path} on: {device}")

    tokenizer = AutoTokenizer.from_pretrained(model_path, local_files_only=True)

    if tokenizer.pad_token is None:
        tokenizer.pad_token = tokenizer.eos_token

    eval_metrics = {metric: evaluate.load(metric) for metric in metric_names}

    predictions = []
    references = []

    for example in test_dataset:
        inputs = tokenizer(example["article"], max_length=1024, truncation=True, padding=True, return_tensors="pt")
        inputs = {key: tensor.to(model.device) for key, tensor in inputs.items()}
        with torch.no_grad():
            outputs = model.generate(input_ids=inputs["input_ids"], max_new_tokens=142, num_beams=5)
        decoded_pred = tokenizer.decode(outputs[0], skip_special_tokens=True)
        decoded_ref = example["highlights"]

        predictions.append(decoded_pred)
        references.append(decoded_ref)

    results = {}
    for metric_name, metric in eval_metrics.items():
        if metric_name == "bertscore":
            results[metric_name] = metric.compute(predictions=predictions, references=references, lang="en")
        else:
            results[metric_name] = metric.compute(predictions=predictions, references=references)

    return results


def compare_models(pretrained_model_path, fine_tuned_model_path, test_dataset):
    print(f"Evaluating {pretrained_model_path.name} (Pretrained)...")
    pretrained_results = evaluate_model(pretrained_model_path, test_dataset)

    print(f"Evaluating {pretrained_model_path.name} (Fine-tuned)...")
    fine_tuned_results = evaluate_model(fine_tuned_model_path, test_dataset)

    print(f"Comparison for {pretrained_model_path.name}:")
    print("Pretrained Results:")
    for metric, scores in pretrained_results.items():
        print(f"  {metric}:", {k: round(v, 4) if isinstance(v, float) else v for k, v in scores.items()})
    print("Fine-tuned Results:")
    for metric, scores in fine_tuned_results.items():
        print(f"  {metric}:", {k: round(v, 4) if isinstance(v, float) else v for k, v in scores.items()})
    print()


dataset = load_dataset("abisee/cnn_dailymail", "3.0.0")
test_data = dataset["test"].select(range(100))        #test
# print(test_data[0])

this_file = Path(__file__).resolve()
project_root = this_file.parents[2]     #ml6_project

pretrained_dir = project_root/"pretrained"
finetuned_dir = project_root/"finetuned"

pairs_to_evaluate = [
    {
        "pretrained": pretrained_dir/"t5-small",
        "fine_tuned": finetuned_dir/"t5_small_15_trials_best_additional_preprocess"/"trial_11"/"checkpoint-657"
    },
    {
        "pretrained": pretrained_dir/"t5-large",
        "fine_tuned": finetuned_dir/"t5_large_10_trials_best"/"trial_0"/"checkpoint-876"
    },
    {
        "pretrained": pretrained_dir/"bart-base",
        "fine_tuned": finetuned_dir/"bart_output_small"/"best_model_small"/"checkpoint-1752"
    },
    {
        "pretrained": pretrained_dir/"bart-large",
        "fine_tuned": finetuned_dir/"bart_output_large"/"best_model_large"/"checkpoint-2100"
    },
]

for pair in pairs_to_evaluate:
    compare_models(pair["pretrained"], pair["fine_tuned"], test_data)





"""
output: (range(100))

Comparison for t5-small:
Pretrained Results:
  rouge: {'rouge1': np.float64(0.255), 'rouge2': np.float64(0.0862), 'rougeL': np.float64(0.1884), 'rougeLsum': np.float64(0.2125)}
  bertscore: {'precision': [0.8481583595275879, 0.8500116467475891, 0.8672924041748047, 0.839491605758667, 0.8603981733322144, 0.8539698123931885, 0.8820129036903381, 0.8373657464981079, 0.8286304473876953, 0.8501328825950623, 0.8672032356262207, 0.8602851033210754, 0.8631803393363953, 0.8280783891677856, 0.8261541128158569, 0.8486835956573486, 0.8304635286331177, 0.8584408164024353, 0.8594757318496704, 0.8220463991165161, 0.8623993396759033, 0.8526321649551392, 0.8458042144775391, 0.8927043676376343, 0.8733474016189575, 0.8196698427200317, 0.8575212955474854, 0.8192136287689209, 0.8244529962539673, 0.8318127989768982, 0.8766118288040161, 0.8466156721115112, 0.8369549512863159, 0.8022661209106445, 0.8164874315261841, 0.8590591549873352, 0.829693078994751, 0.8803885579109192, 0.8565706014633179, 0.8159775733947754, 0.8507472276687622, 0.8556551933288574, 0.8384828567504883, 0.8611918091773987, 0.8605531454086304, 0.8257806301116943, 0.8492867946624756, 0.8305971026420593, 0.8651272654533386, 0.8769159317016602, 0.8334982395172119, 0.885680079460144, 0.8708930015563965, 0.8490667343139648, 0.8245493173599243, 0.8560459613800049, 0.8732047080993652, 0.8125195503234863, 0.8616186380386353, 0.7982667684555054, 0.8649369478225708, 0.8297244310379028, 0.8794251084327698, 0.8339765071868896, 0.8878275752067566, 0.8739757537841797, 0.8486391305923462, 0.8116670250892639, 0.8606898784637451, 0.8560245037078857, 0.8875893950462341, 0.8591734170913696, 0.8844760060310364, 0.8021628260612488, 0.8916914463043213, 0.840835690498352, 0.830349326133728, 0.8558639287948608, 0.8133327960968018, 0.871813952922821, 0.8722505569458008, 0.8836176991462708, 0.8305116891860962, 0.9030790328979492, 0.8835340738296509, 0.8467124104499817, 0.8442721366882324, 0.8396322727203369, 0.9133267998695374, 0.7950883507728577, 0.8537963628768921, 0.8493213653564453, 0.8292804956436157, 0.8325099945068359, 0.836452305316925, 0.8541051149368286, 0.857107400894165, 0.8782017230987549, 0.8325527906417847, 0.832534909248352], 'recall': [0.850879967212677, 0.8663124442100525, 0.8596957325935364, 0.857250988483429, 0.8512521386146545, 0.8519622087478638, 0.8770558834075928, 0.8613609075546265, 0.8421722650527954, 0.868370532989502, 0.8789733648300171, 0.8658769726753235, 0.8790491223335266, 0.8323978185653687, 0.8193321824073792, 0.8401648998260498, 0.8294789791107178, 0.8346556425094604, 0.8474974632263184, 0.8232361078262329, 0.8544228076934814, 0.833845317363739, 0.8259032368659973, 0.8828264474868774, 0.8890519142150879, 0.8226304650306702, 0.8659023642539978, 0.8416119813919067, 0.846523642539978, 0.8449101448059082, 0.8834323883056641, 0.8400583863258362, 0.8902391195297241, 0.8523621559143066, 0.82906174659729, 0.8562396764755249, 0.8392022848129272, 0.8691476583480835, 0.8492494821548462, 0.8273195028305054, 0.8787351846694946, 0.8428184986114502, 0.876375138759613, 0.8528715372085571, 0.8867964744567871, 0.8333779573440552, 0.9032094478607178, 0.8264555931091309, 0.8614473938941956, 0.8653605580329895, 0.8243711590766907, 0.8974286913871765, 0.8891603350639343, 0.8607578277587891, 0.814714789390564, 0.8845586776733398, 0.8569206595420837, 0.8062025308609009, 0.8585627675056458, 0.8452619910240173, 0.8597185611724854, 0.8142839670181274, 0.8943202495574951, 0.8597756624221802, 0.8693603277206421, 0.8786334991455078, 0.8420854806900024, 0.8556064367294312, 0.8481941819190979, 0.8598138093948364, 0.89991295337677, 0.8813726305961609, 0.8766679763793945, 0.8262253999710083, 0.8762608766555786, 0.8335635662078857, 0.8432974815368652, 0.8411691784858704, 0.849280834197998, 0.8729004859924316, 0.888154149055481, 0.8716593980789185, 0.8410365581512451, 0.9392805099487305, 0.8958033919334412, 0.8302992582321167, 0.8584469556808472, 0.8504233360290527, 0.8956559896469116, 0.8314796686172485, 0.8708754181861877, 0.8814166784286499, 0.8314787149429321, 0.83559250831604, 0.8726139068603516, 0.8268218040466309, 0.8603765964508057, 0.8545737266540527, 0.8346892595291138, 0.8520400524139404], 'f1': [0.8495169878005981, 0.8580846786499023, 0.863477349281311, 0.8482784032821655, 0.8558006882667542, 0.8529648780822754, 0.8795274496078491, 0.8491938710212708, 0.8353464603424072, 0.8591548800468445, 0.8730486631393433, 0.8630719780921936, 0.8710424304008484, 0.8302325010299683, 0.8227289915084839, 0.8444027304649353, 0.8299709558486938, 0.8463811874389648, 0.8534445762634277, 0.8226407766342163, 0.8583925366401672, 0.8431341052055359, 0.8357352614402771, 0.8877379298210144, 0.8811296820640564, 0.8211475014686584, 0.861691415309906, 0.830261766910553, 0.8353425860404968, 0.8383103013038635, 0.8800089359283447, 0.8433243036270142, 0.8627751469612122, 0.8265557289123535, 0.8227265477180481, 0.8576470613479614, 0.8344205617904663, 0.8747320175170898, 0.8528943657875061, 0.821609377861023, 0.8645147681236267, 0.8491883277893066, 0.8570103645324707, 0.8570114374160767, 0.8734777569770813, 0.8295618891716003, 0.8754186034202576, 0.8285211324691772, 0.8632833957672119, 0.8711000084877014, 0.8289096355438232, 0.8915157318115234, 0.8799318671226501, 0.8548723459243774, 0.8196025490760803, 0.8700687885284424, 0.8649860620498657, 0.8093487620353699, 0.8600879311561584, 0.8210924863815308, 0.862319827079773, 0.8219316601753235, 0.8868101835250854, 0.8466796278953552, 0.8784969449043274, 0.8762984871864319, 0.8453495502471924, 0.833057701587677, 0.8543963432312012, 0.8579149842262268, 0.8937087059020996, 0.8701314926147461, 0.880554735660553, 0.8140163421630859, 0.8839088082313538, 0.8371838331222534, 0.8367733359336853, 0.8484529256820679, 0.8309181928634644, 0.8723568320274353, 0.8801305294036865, 0.8775977492332458, 0.8357409834861755, 0.9208241105079651, 0.8896264433860779, 0.8384254574775696, 0.8513005375862122, 0.8449933528900146, 0.9044050574302673, 0.8128768801689148, 0.8622512817382812, 0.8650714159011841, 0.8303781151771545, 0.8340484499931335, 0.8541505932807922, 0.8402420282363892, 0.858738899230957, 0.8662266135215759, 0.8336196541786194, 0.8421745896339417], 'hashcode': 'roberta-large_L17_no-idf_version=0.3.12(hug_trans=4.52.3)'}
Fine-tuned Results:
  rouge: {'rouge1': np.float64(0.2958), 'rouge2': np.float64(0.1079), 'rougeL': np.float64(0.2135), 'rougeLsum': np.float64(0.2486)}
  bertscore: {'precision': [0.8594087362289429, 0.8512440919876099, 0.8327746391296387, 0.8678649067878723, 0.8667117357254028, 0.8487196564674377, 0.8454226851463318, 0.8314903974533081, 0.8224108219146729, 0.8373013734817505, 0.8546491265296936, 0.8580090999603271, 0.8405208587646484, 0.8368437886238098, 0.8347778916358948, 0.8436354994773865, 0.8600882291793823, 0.8637088537216187, 0.8989368677139282, 0.8169188499450684, 0.8554100394248962, 0.8448061943054199, 0.8201472759246826, 0.8370290994644165, 0.8742759227752686, 0.8561515212059021, 0.8506172895431519, 0.8110945820808411, 0.8523083329200745, 0.8772405982017517, 0.8748038411140442, 0.8402987718582153, 0.8345609903335571, 0.8173878788948059, 0.82442307472229, 0.8470579385757446, 0.8482359051704407, 0.8448405265808105, 0.8571863174438477, 0.8153998851776123, 0.843436598777771, 0.8491580486297607, 0.8291215896606445, 0.8578711152076721, 0.8665767908096313, 0.8647043704986572, 0.8718909621238708, 0.8373852968215942, 0.8535768985748291, 0.8572133183479309, 0.8445947170257568, 0.8872385025024414, 0.8897926211357117, 0.8430052995681763, 0.8334342241287231, 0.854621410369873, 0.8523072004318237, 0.8489083647727966, 0.8670802116394043, 0.832694411277771, 0.8898838758468628, 0.8272796869277954, 0.8766961097717285, 0.8563926815986633, 0.8535394072532654, 0.8508446216583252, 0.8298307657241821, 0.820138692855835, 0.8950777053833008, 0.8555338382720947, 0.8474661111831665, 0.8503652811050415, 0.8935522437095642, 0.834293007850647, 0.8904796838760376, 0.8565162420272827, 0.839410662651062, 0.8662091493606567, 0.8455497026443481, 0.8588811755180359, 0.8999162316322327, 0.8672505617141724, 0.8566514253616333, 0.8906491994857788, 0.88306725025177, 0.8316828012466431, 0.863566517829895, 0.834983229637146, 0.8737568855285645, 0.8223811388015747, 0.8768920302391052, 0.8674717545509338, 0.825364351272583, 0.8651622533798218, 0.8515806198120117, 0.8583647608757019, 0.8669105172157288, 0.8891780972480774, 0.8448320031166077, 0.8300313949584961], 'recall': [0.8708090782165527, 0.8574398756027222, 0.8397159576416016, 0.8792024254798889, 0.887617290019989, 0.8525753021240234, 0.8566135168075562, 0.8391117453575134, 0.8552740812301636, 0.8761782646179199, 0.8834854364395142, 0.8614060878753662, 0.8389192223548889, 0.8302114605903625, 0.8447803854942322, 0.8525859117507935, 0.8602650761604309, 0.8479450941085815, 0.8944879174232483, 0.8351944088935852, 0.8586112260818481, 0.8349113464355469, 0.839076042175293, 0.8617411851882935, 0.8682934641838074, 0.8803638219833374, 0.871076226234436, 0.8460205793380737, 0.8827368021011353, 0.9062821865081787, 0.8696359992027283, 0.846072793006897, 0.9143016338348389, 0.8670008778572083, 0.8359612822532654, 0.8498128652572632, 0.8624685406684875, 0.8639962077140808, 0.8636122941970825, 0.829674243927002, 0.8770272731781006, 0.8392965793609619, 0.9011882543563843, 0.8692320585250854, 0.8792812824249268, 0.8921294808387756, 0.9354274868965149, 0.8292231559753418, 0.8690870404243469, 0.8640308380126953, 0.8210976719856262, 0.8856688141822815, 0.9029538035392761, 0.8204236626625061, 0.8286805152893066, 0.8711304664611816, 0.8710554838180542, 0.8734074831008911, 0.8626143932342529, 0.898935854434967, 0.9080814123153687, 0.8261215090751648, 0.8968814611434937, 0.8797739148139954, 0.8354206085205078, 0.8811560869216919, 0.8375035524368286, 0.920722246170044, 0.8680227994918823, 0.8710231781005859, 0.8321840763092041, 0.8837502598762512, 0.899761438369751, 0.841642439365387, 0.9090180993080139, 0.8491624593734741, 0.8483588695526123, 0.863872766494751, 0.8558790683746338, 0.8780815601348877, 0.9191524982452393, 0.8461247682571411, 0.8676800727844238, 0.8909205198287964, 0.9044955968856812, 0.832071840763092, 0.8689401149749756, 0.8610567450523376, 0.8804281949996948, 0.857879638671875, 0.8973066210746765, 0.8822112679481506, 0.836373507976532, 0.8731379508972168, 0.8805074691772461, 0.8365768790245056, 0.8986882567405701, 0.8904213309288025, 0.842424213886261, 0.8489328622817993], 'f1': [0.8650713562965393, 0.8543307781219482, 0.8362308740615845, 0.8734968900680542, 0.8770399689674377, 0.8506430983543396, 0.8509813547134399, 0.8352837562561035, 0.8385205864906311, 0.8562988042831421, 0.8688279986381531, 0.8597042560577393, 0.839719295501709, 0.833514392375946, 0.8397493958473206, 0.8480870723724365, 0.8601766228675842, 0.8557544350624084, 0.8967068791389465, 0.8259556293487549, 0.8570076823234558, 0.8398296236991882, 0.8295036554336548, 0.8492053747177124, 0.8712744116783142, 0.8680889010429382, 0.8607251644134521, 0.828189492225647, 0.867255687713623, 0.8915249705314636, 0.8722122311592102, 0.8431759476661682, 0.8726134300231934, 0.8414636850357056, 0.8301520943641663, 0.8484331369400024, 0.8552930355072021, 0.854310929775238, 0.8603873252868652, 0.8224751353263855, 0.8599039912223816, 0.84419846534729, 0.8636541366577148, 0.8635141849517822, 0.8728827834129333, 0.8782029151916504, 0.9025424122810364, 0.8332842588424683, 0.8612621426582336, 0.8606086373329163, 0.8326804637908936, 0.8864529728889465, 0.8963249325752258, 0.8315611481666565, 0.8310505747795105, 0.8627969622612, 0.8615793585777283, 0.8609837293624878, 0.8648415207862854, 0.8645480871200562, 0.8988905549049377, 0.8267002105712891, 0.8866739273071289, 0.8679258227348328, 0.8443828225135803, 0.8657351136207581, 0.8336495161056519, 0.8675246834754944, 0.8813426494598389, 0.8632090091705322, 0.8397555947303772, 0.8667364120483398, 0.8966460824012756, 0.8379515409469604, 0.8996533751487732, 0.8528234958648682, 0.8438610434532166, 0.8650393486022949, 0.8506830334663391, 0.8683752417564392, 0.9094326496124268, 0.8565574288368225, 0.8621304631233215, 0.8907848000526428, 0.8936529755592346, 0.8318772315979004, 0.8662450313568115, 0.8478195667266846, 0.8770798444747925, 0.8397554159164429, 0.8869819045066833, 0.8747794032096863, 0.8308324217796326, 0.869131863117218, 0.8658024668693542, 0.8473307490348816, 0.8825134038925171, 0.8897992968559265, 0.8436263799667358, 0.8393757343292236], 'hashcode': 'roberta-large_L17_no-idf_version=0.3.12(hug_trans=4.52.3)'}


Comparison for t5-large:
Pretrained Results:
  rouge: {'rouge1': np.float64(0.2392), 'rouge2': np.float64(0.079), 'rougeL': np.float64(0.1736), 'rougeLsum': np.float64(0.2048)}
  bertscore: {'precision': [0.8342598676681519, 0.8535467386245728, 0.8404509425163269, 0.8362664580345154, 0.8529164791107178, 0.8047512769699097, 0.803030788898468, 0.848041296005249, 0.8334912061691284, 0.8175276517868042, 0.8479524850845337, 0.8296146988868713, 0.8580515384674072, 0.8362596035003662, 0.8051434755325317, 0.8538721799850464, 0.8392612934112549, 0.8568705320358276, 0.8523646593093872, 0.8254963755607605, 0.8569686412811279, 0.8249257802963257, 0.8181003332138062, 0.8633728623390198, 0.8408151865005493, 0.8351538181304932, 0.8516553640365601, 0.8165565729141235, 0.844027042388916, 0.8108588457107544, 0.871401309967041, 0.8001607060432434, 0.8252297043800354, 0.8007070422172546, 0.8028880953788757, 0.8353143930435181, 0.7960987687110901, 0.860621452331543, 0.849461555480957, 0.815688967704773, 0.8421366214752197, 0.7775250673294067, 0.800424337387085, 0.8713732361793518, 0.8475742340087891, 0.7972341775894165, 0.8615020513534546, 0.8254581689834595, 0.8521938323974609, 0.8608717918395996, 0.8218882083892822, 0.8561221361160278, 0.8359742164611816, 0.8548547029495239, 0.8220970630645752, 0.839824914932251, 0.7176711559295654, 0.831358790397644, 0.8696792721748352, 0.8175031542778015, 0.8653191328048706, 0.8402128219604492, 0.8614325523376465, 0.8294601440429688, 0.8773193359375, 0.7664149403572083, 0.8132238388061523, 0.8606009483337402, 0.8634845614433289, 0.8491066098213196, 0.8465907573699951, 0.8474388122558594, 0.862378716468811, 0.8287910223007202, 0.8721299767494202, 0.8240784406661987, 0.8091824650764465, 0.8333749771118164, 0.8266496658325195, 0.7739291191101074, 0.8623561263084412, 0.8457537889480591, 0.8490048050880432, 0.868187665939331, 0.85423743724823, 0.8161301612854004, 0.8696794509887695, 0.8435243368148804, 0.8538894653320312, 0.8209228515625, 0.7764624357223511, 0.8267756104469299, 0.8238087296485901, 0.8474326133728027, 0.8536417484283447, 0.791266143321991, 0.8349053859710693, 0.8560240864753723, 0.8217858076095581, 0.8480589985847473], 'recall': [0.858166515827179, 0.8730844855308533, 0.8692930936813354, 0.833687424659729, 0.8823662996292114, 0.8264708518981934, 0.8045466542243958, 0.8839000463485718, 0.8487457036972046, 0.846185564994812, 0.8525568246841431, 0.8670084476470947, 0.8967141509056091, 0.8271239399909973, 0.8275111317634583, 0.8661789894104004, 0.8221564292907715, 0.8514530062675476, 0.8685956001281738, 0.8554854989051819, 0.8658225536346436, 0.8109506368637085, 0.859052836894989, 0.9022297859191895, 0.8830567598342896, 0.8262391090393066, 0.8547133207321167, 0.8333443999290466, 0.8783977031707764, 0.8304357528686523, 0.8896892666816711, 0.8197005987167358, 0.8836665153503418, 0.896690845489502, 0.8118487596511841, 0.8493906259536743, 0.825933575630188, 0.8867303729057312, 0.8772045373916626, 0.8394294381141663, 0.900227427482605, 0.7995835542678833, 0.8080266714096069, 0.9046988487243652, 0.8921021223068237, 0.8075675368309021, 0.9229217767715454, 0.8221782445907593, 0.8774158954620361, 0.8443785309791565, 0.8219082355499268, 0.8733408451080322, 0.8727824091911316, 0.8764517307281494, 0.8378182649612427, 0.8542141318321228, 0.7787911295890808, 0.8563507795333862, 0.8814809322357178, 0.8580718040466309, 0.8457693457603455, 0.8397749662399292, 0.8650946021080017, 0.8460428714752197, 0.8851975202560425, 0.8303730487823486, 0.8270494937896729, 0.9140698313713074, 0.8958215713500977, 0.8824610114097595, 0.8318260908126831, 0.8715243339538574, 0.9024910926818848, 0.8213780522346497, 0.889877200126648, 0.835304319858551, 0.8325932025909424, 0.818166971206665, 0.8455963730812073, 0.8476897478103638, 0.8591116070747375, 0.8485879898071289, 0.8694289922714233, 0.9390653371810913, 0.8636118173599243, 0.8201748132705688, 0.8880446553230286, 0.8940413594245911, 0.873603105545044, 0.8491309881210327, 0.8175357580184937, 0.9003791809082031, 0.8259619474411011, 0.8793660402297974, 0.910952627658844, 0.8023058176040649, 0.8313705325126648, 0.8734853863716125, 0.7972372770309448, 0.8705374002456665], 'f1': [0.8460443019866943, 0.863205075263977, 0.8546288013458252, 0.8349749445915222, 0.8673914670944214, 0.8154665231704712, 0.8037880063056946, 0.8655994534492493, 0.841049313545227, 0.8316097855567932, 0.8502484560012817, 0.8478994965553284, 0.8769568800926208, 0.8316667079925537, 0.8161740303039551, 0.8599815368652344, 0.8306207656860352, 0.8541532158851624, 0.8604035973548889, 0.8402234315872192, 0.8613728284835815, 0.8178785443305969, 0.8380765914916992, 0.8823737502098083, 0.8614184260368347, 0.830672562122345, 0.8531816005706787, 0.8248651027679443, 0.8608694672584534, 0.8205305337905884, 0.8804503083229065, 0.8098127245903015, 0.8534489870071411, 0.8459851145744324, 0.807343602180481, 0.8422937393188477, 0.8107417821884155, 0.8734808564186096, 0.8631101846694946, 0.8273888826370239, 0.8702136278152466, 0.7883999943733215, 0.8042075634002686, 0.887723445892334, 0.8692682981491089, 0.802367627620697, 0.8911548852920532, 0.8238149285316467, 0.8646209836006165, 0.852545440196991, 0.8218982219696045, 0.864645779132843, 0.8539818525314331, 0.8655185103416443, 0.8298831582069397, 0.846958339214325, 0.7469829320907593, 0.8436697125434875, 0.8755403161048889, 0.8372963070869446, 0.8554325699806213, 0.8399938344955444, 0.8632596731185913, 0.8376694917678833, 0.8812408447265625, 0.7971131205558777, 0.820078432559967, 0.8865298628807068, 0.8793558478355408, 0.8654625415802002, 0.8391435146331787, 0.8593128323554993, 0.8819791078567505, 0.8250678181648254, 0.8809142112731934, 0.8296533823013306, 0.8207209706306458, 0.8257009387016296, 0.8360157608985901, 0.8091318607330322, 0.8607308268547058, 0.847168505191803, 0.8590955138206482, 0.9022367000579834, 0.8588990569114685, 0.8181474804878235, 0.8787661194801331, 0.8680484294891357, 0.8636338114738464, 0.8347886800765991, 0.7964699268341064, 0.8620090484619141, 0.8248838782310486, 0.8631040453910828, 0.881366491317749, 0.7967478036880493, 0.8331342339515686, 0.8646665811538696, 0.8093254566192627, 0.8591511249542236], 'hashcode': 'roberta-large_L17_no-idf_version=0.3.12(hug_trans=4.52.3)'}
Fine-tuned Results:
  rouge: {'rouge1': np.float64(0.2652), 'rouge2': np.float64(0.0991), 'rougeL': np.float64(0.1857), 'rougeLsum': np.float64(0.2196)}
  bertscore: {'precision': [0.9063887596130371, 0.8619798421859741, 0.8716384172439575, 0.8309805393218994, 0.8614155054092407, 0.8020505905151367, 0.8522082567214966, 0.8577694892883301, 0.8390239477157593, 0.8297210931777954, 0.8626283407211304, 0.832796573638916, 0.8759720325469971, 0.8067883253097534, 0.7736196517944336, 0.8802956342697144, 0.7872341871261597, 0.8607283234596252, 0.8464527130126953, 0.8353021144866943, 0.831213653087616, 0.8580898642539978, 0.8578041791915894, 0.825412392616272, 0.8629500865936279, 0.8345585465431213, 0.8481714129447937, 0.8243225812911987, 0.8403048515319824, 0.8303167223930359, 0.8403599858283997, 0.8100400567054749, 0.8380393385887146, 0.8474493622779846, 0.8251386880874634, 0.8900612592697144, 0.8078299760818481, 0.8965016007423401, 0.8719063997268677, 0.824351966381073, 0.8529057502746582, 0.836861252784729, 0.8655580878257751, 0.8508611917495728, 0.8496073484420776, 0.829954981803894, 0.8746134042739868, 0.8400781154632568, 0.8615943789482117, 0.8688700795173645, 0.821641206741333, 0.8698213696479797, 0.8693885803222656, 0.8718541264533997, 0.8223965167999268, 0.8430364727973938, 0.7393324375152588, 0.8610796928405762, 0.8604259490966797, 0.8639246821403503, 0.8696737289428711, 0.8506391644477844, 0.8742387890815735, 0.8317579030990601, 0.9057340621948242, 0.8248653411865234, 0.8277409076690674, 0.884888768196106, 0.8872205018997192, 0.8571870923042297, 0.8534034490585327, 0.860213041305542, 0.8453913927078247, 0.810596764087677, 0.8755862712860107, 0.8355079889297485, 0.8492513298988342, 0.8524966239929199, 0.8443963527679443, 0.8144073486328125, 0.8336601853370667, 0.8394550681114197, 0.8469723463058472, 0.8764841556549072, 0.8838879466056824, 0.8378793597221375, 0.8578599095344543, 0.8323623538017273, 0.8620133399963379, 0.8220953941345215, 0.8009390830993652, 0.8514476418495178, 0.8342783451080322, 0.8432186245918274, 0.8428672552108765, 0.7478044629096985, 0.8401442766189575, 0.8596577048301697, 0.8412338495254517, 0.8294857144355774], 'recall': [0.9182633757591248, 0.8709218502044678, 0.8739040493965149, 0.8458631038665771, 0.8800552487373352, 0.8218178153038025, 0.8765967488288879, 0.8728109002113342, 0.8543125987052917, 0.8452427387237549, 0.8888339996337891, 0.8560478687286377, 0.9076250791549683, 0.8149234652519226, 0.8029127717018127, 0.8749818205833435, 0.7994431257247925, 0.8612419366836548, 0.8668302297592163, 0.8632534742355347, 0.8700604438781738, 0.8397631645202637, 0.8746712803840637, 0.8569152355194092, 0.8938719630241394, 0.8568967580795288, 0.8829840421676636, 0.8403846025466919, 0.8727977275848389, 0.8940442204475403, 0.8556146621704102, 0.8402540683746338, 0.9239108562469482, 0.8799782395362854, 0.8304771184921265, 0.9000754356384277, 0.8299839496612549, 0.9019417762756348, 0.8861182332038879, 0.8473076820373535, 0.9192834496498108, 0.8283995389938354, 0.9006602764129639, 0.8810997009277344, 0.9078190326690674, 0.8269631862640381, 0.903110146522522, 0.8432576656341553, 0.853164553642273, 0.9103020429611206, 0.824224591255188, 0.9012099504470825, 0.8867111206054688, 0.8825207948684692, 0.848129391670227, 0.8671424984931946, 0.8137471675872803, 0.8859527111053467, 0.8769596219062805, 0.9110299944877625, 0.895805299282074, 0.8517932295799255, 0.9042357802391052, 0.8237372636795044, 0.9207290410995483, 0.8255895376205444, 0.8580185174942017, 0.935961127281189, 0.8948686122894287, 0.8894670605659485, 0.8979288339614868, 0.9185465574264526, 0.8649752736091614, 0.8259885311126709, 0.8953118324279785, 0.8455561399459839, 0.8714419007301331, 0.8520215749740601, 0.8816077709197998, 0.8556486964225769, 0.8670409917831421, 0.8209073543548584, 0.8693268299102783, 0.9413540363311768, 0.9269921779632568, 0.8386762738227844, 0.8860349655151367, 0.877446174621582, 0.8951007723808289, 0.8633490800857544, 0.8342897891998291, 0.9073931574821472, 0.8448871374130249, 0.8701953887939453, 0.8795467615127563, 0.8006618618965149, 0.8850079774856567, 0.8819360733032227, 0.8763225674629211, 0.8470538854598999], 'f1': [0.9122873544692993, 0.8664277791976929, 0.8727697134017944, 0.8383557796478271, 0.8706355690956116, 0.8118138313293457, 0.8642304539680481, 0.8652248978614807, 0.846599280834198, 0.8374099731445312, 0.8755351305007935, 0.8442621827125549, 0.891517698764801, 0.8108355402946472, 0.7879941463470459, 0.8776307106018066, 0.7932916283607483, 0.8609850406646729, 0.8565202951431274, 0.8490477800369263, 0.8501935005187988, 0.848827600479126, 0.8661555647850037, 0.8408688902854919, 0.8781388998031616, 0.8455801010131836, 0.8652276992797852, 0.8322761058807373, 0.8562431335449219, 0.8610028624534607, 0.8479187488555908, 0.8248705267906189, 0.8788825273513794, 0.863407552242279, 0.8277993202209473, 0.8950403332710266, 0.8187571167945862, 0.8992134928703308, 0.8789548277854919, 0.8356721997261047, 0.8848515152931213, 0.8326088786125183, 0.8827603459358215, 0.8657164573669434, 0.8777490854263306, 0.8284564018249512, 0.8886333703994751, 0.8416649103164673, 0.8573588132858276, 0.8891035914421082, 0.8229308724403381, 0.885237455368042, 0.8779643774032593, 0.8771550059318542, 0.8350647687911987, 0.8549195528030396, 0.7747570276260376, 0.8733391761779785, 0.868614137172699, 0.8868522644042969, 0.882546067237854, 0.8512157797813416, 0.8889843225479126, 0.8277281522750854, 0.9131700396537781, 0.8252272605895996, 0.8426077961921692, 0.9097086787223816, 0.8910281658172607, 0.8730287551879883, 0.8751001358032227, 0.8884233236312866, 0.8550711870193481, 0.818220317363739, 0.8853392004966736, 0.8405020833015442, 0.8602035641670227, 0.8522590398788452, 0.8626009225845337, 0.8345187902450562, 0.8500229716300964, 0.8300776481628418, 0.8580039739608765, 0.9077616333961487, 0.9049270153045654, 0.8382776379585266, 0.8717198371887207, 0.8543098568916321, 0.87824547290802, 0.8422173857688904, 0.8172743320465088, 0.8785306811332703, 0.8395492434501648, 0.856494665145874, 0.860816478729248, 0.7733309864997864, 0.8619927763938904, 0.8706544041633606, 0.8584197759628296, 0.8381776809692383], 'hashcode': 'roberta-large_L17_no-idf_version=0.3.12(hug_trans=4.52.3)'}


Comparison for bart-base:
Pretrained Results:
  rouge: {'rouge1': np.float64(0.2675), 'rouge2': np.float64(0.1205), 'rougeL': np.float64(0.1909), 'rougeLsum': np.float64(0.2206)}
  bertscore: {'precision': [0.8589667677879333, 0.8490464687347412, 0.8209517002105713, 0.8467094302177429, 0.8642120361328125, 0.824783205986023, 0.8317935466766357, 0.8459774851799011, 0.8368347883224487, 0.8350323438644409, 0.8589934706687927, 0.8185540437698364, 0.8326229453086853, 0.8186619281768799, 0.808212161064148, 0.8377436995506287, 0.8053833246231079, 0.8485814929008484, 0.837867259979248, 0.8218635320663452, 0.8298210501670837, 0.8316325545310974, 0.8256118297576904, 0.8311617374420166, 0.851006269454956, 0.8383145332336426, 0.8256861567497253, 0.8254688382148743, 0.8218474388122559, 0.8370624780654907, 0.8846818208694458, 0.8120630979537964, 0.825962483882904, 0.818313717842102, 0.8450414538383484, 0.8656673431396484, 0.8205689787864685, 0.85771244764328, 0.8361508846282959, 0.7960909008979797, 0.8150993585586548, 0.800336480140686, 0.8379679918289185, 0.8504451513290405, 0.8309527635574341, 0.8073744773864746, 0.8293527364730835, 0.8267872929573059, 0.8661359548568726, 0.8429791331291199, 0.8248316049575806, 0.8435074090957642, 0.8316535949707031, 0.8514662981033325, 0.8330823183059692, 0.8373062610626221, 0.8339338302612305, 0.8388044834136963, 0.8588970899581909, 0.8407189846038818, 0.8635135293006897, 0.8092662692070007, 0.8339437246322632, 0.8399131298065186, 0.8500458002090454, 0.8432403802871704, 0.8124774694442749, 0.8231185674667358, 0.8526672124862671, 0.8224705457687378, 0.840774416923523, 0.8422587513923645, 0.8441967964172363, 0.8129923343658447, 0.8624898791313171, 0.8287707567214966, 0.8103640079498291, 0.8464350700378418, 0.8388425707817078, 0.8247816562652588, 0.8083676099777222, 0.8389585018157959, 0.8453633785247803, 0.8467152118682861, 0.8762179613113403, 0.8405524492263794, 0.855674684047699, 0.8267995119094849, 0.8501102328300476, 0.7964935302734375, 0.8308616876602173, 0.8114408850669861, 0.8204015493392944, 0.8344073295593262, 0.8320924043655396, 0.81360924243927, 0.831244945526123, 0.8334060907363892, 0.8185275197029114, 0.8310891389846802], 'recall': [0.9029407501220703, 0.8934204578399658, 0.8524535894393921, 0.8812212347984314, 0.9144619703292847, 0.8799389600753784, 0.8610161542892456, 0.8912593126296997, 0.9034353494644165, 0.895311713218689, 0.9194573163986206, 0.8589906692504883, 0.9003424644470215, 0.8373656272888184, 0.860153079032898, 0.8617993593215942, 0.8114936351776123, 0.8551790118217468, 0.8978753685951233, 0.8696007132530212, 0.8580794334411621, 0.8361058235168457, 0.8544121980667114, 0.9153713583946228, 0.8954407572746277, 0.8744286894798279, 0.8686767220497131, 0.8931041359901428, 0.8916354179382324, 0.9017792344093323, 0.9214948415756226, 0.838464617729187, 0.9176130294799805, 0.8902258276939392, 0.9060457348823547, 0.8986026048660278, 0.8778917193412781, 0.8918205499649048, 0.874917209148407, 0.8373937606811523, 0.8958443999290466, 0.8138632774353027, 0.9213700294494629, 0.9005042314529419, 0.8951160907745361, 0.8462844491004944, 0.917595386505127, 0.8384820222854614, 0.9271023273468018, 0.9254103899002075, 0.8503255248069763, 0.8812757134437561, 0.8788307905197144, 0.9017725586891174, 0.8844954371452332, 0.8712723255157471, 0.8671735525131226, 0.878746747970581, 0.9000888466835022, 0.9071331024169922, 0.9153093099594116, 0.8305859565734863, 0.9019932150840759, 0.8814594745635986, 0.8936664462089539, 0.8967083692550659, 0.8447660207748413, 0.905713677406311, 0.8858755826950073, 0.8683203458786011, 0.8704338073730469, 0.9093019962310791, 0.9017754793167114, 0.8298601508140564, 0.9235153794288635, 0.8466840982437134, 0.8360885381698608, 0.8668004870414734, 0.8952943086624146, 0.8992764353752136, 0.8329663276672363, 0.8837571144104004, 0.8675139546394348, 0.938006579875946, 0.9205546379089355, 0.8629881143569946, 0.8957312703132629, 0.8692431449890137, 0.8911381959915161, 0.85873943567276, 0.8941969871520996, 0.8869513273239136, 0.851997971534729, 0.8976628184318542, 0.9034844040870667, 0.838882565498352, 0.8829401731491089, 0.8672736883163452, 0.8511833548545837, 0.861187756061554], 'f1': [0.8804049491882324, 0.8706684112548828, 0.8364061117172241, 0.8636206984519958, 0.8886271715164185, 0.8514688014984131, 0.8461526036262512, 0.8680282831192017, 0.86886066198349, 0.8641220927238464, 0.8881976008415222, 0.8382850289344788, 0.8651595115661621, 0.8279081583023071, 0.8333740830421448, 0.8496013283729553, 0.8084269165992737, 0.8518674373626709, 0.8668340444564819, 0.8450585603713989, 0.8437137007713318, 0.8338631391525269, 0.8397651314735413, 0.8712363839149475, 0.8726582527160645, 0.8559908270835876, 0.8466360569000244, 0.8579555749893188, 0.8553202152252197, 0.8682165145874023, 0.9027131795883179, 0.8250526785850525, 0.869378924369812, 0.8527564406394958, 0.8744809627532959, 0.8818275332450867, 0.8482630252838135, 0.8744340538978577, 0.855094850063324, 0.8162201642990112, 0.853566586971283, 0.807043194770813, 0.8776921629905701, 0.8747590780258179, 0.8618418574333191, 0.8263717293739319, 0.8712453842163086, 0.8325936198234558, 0.8955827355384827, 0.8822736144065857, 0.8373845815658569, 0.8619780540466309, 0.8545915484428406, 0.8758976459503174, 0.8580194711685181, 0.853951632976532, 0.8502289056777954, 0.8583111763000488, 0.8790106177330017, 0.872664213180542, 0.88865727186203, 0.8197875022888184, 0.866634726524353, 0.8601849675178528, 0.8713105320930481, 0.869152843952179, 0.8283072113990784, 0.8624431490898132, 0.8689542412757874, 0.8447737693786621, 0.8553470373153687, 0.8744973540306091, 0.8720366954803467, 0.8213396072387695, 0.891960084438324, 0.8376316428184509, 0.8230253458023071, 0.8564966917037964, 0.8661496043205261, 0.8604196310043335, 0.8204826712608337, 0.8607752919197083, 0.8562954664230347, 0.8900260329246521, 0.8978393077850342, 0.8516225814819336, 0.8752449154853821, 0.8474902510643005, 0.8701408505439758, 0.8264461159706116, 0.8613666892051697, 0.8475175499916077, 0.8359012603759766, 0.8648800253868103, 0.8663200736045837, 0.8260526061058044, 0.8563130497932434, 0.8500027060508728, 0.8345361351966858, 0.8458707928657532], 'hashcode': 'roberta-large_L17_no-idf_version=0.3.12(hug_trans=4.52.3)'}
Fine-tuned Results:
  rouge: {'rouge1': np.float64(0.3387), 'rouge2': np.float64(0.1533), 'rougeL': np.float64(0.2528), 'rougeLsum': np.float64(0.3144)}
  bertscore: {'precision': [0.8945733904838562, 0.8710250854492188, 0.8768573999404907, 0.8640518188476562, 0.8989781737327576, 0.8715558052062988, 0.8598299026489258, 0.8958774209022522, 0.8796347379684448, 0.8666098117828369, 0.9087048172950745, 0.845907986164093, 0.8719965219497681, 0.8387495875358582, 0.8187594413757324, 0.8743842840194702, 0.853680431842804, 0.8724889755249023, 0.8945724964141846, 0.8572554588317871, 0.8561469316482544, 0.8594919443130493, 0.8380311727523804, 0.8809568881988525, 0.8906828165054321, 0.8593400716781616, 0.871574878692627, 0.8424214124679565, 0.8543187379837036, 0.871335506439209, 0.894306480884552, 0.8417527675628662, 0.8403116464614868, 0.8129067420959473, 0.911664605140686, 0.9184800386428833, 0.8605323433876038, 0.8688326478004456, 0.8823038339614868, 0.8373196125030518, 0.8592609167098999, 0.8275363445281982, 0.8846672773361206, 0.8773131966590881, 0.8425543308258057, 0.860463559627533, 0.8885035514831543, 0.8359811305999756, 0.8918884992599487, 0.8690081834793091, 0.8272150754928589, 0.8664001822471619, 0.837828516960144, 0.8792092800140381, 0.8416085243225098, 0.8593818545341492, 0.8712068200111389, 0.8476338982582092, 0.8972880840301514, 0.8390110731124878, 0.8911515474319458, 0.8362385034561157, 0.9063708782196045, 0.865324854850769, 0.9300074577331543, 0.8861096501350403, 0.848032534122467, 0.8736958503723145, 0.9076327085494995, 0.870535135269165, 0.8617408871650696, 0.8544463515281677, 0.887241005897522, 0.8352065086364746, 0.9182941317558289, 0.8661914467811584, 0.822053074836731, 0.8985159397125244, 0.8593077659606934, 0.8824483156204224, 0.9306187033653259, 0.8929680585861206, 0.868622362613678, 0.8996343612670898, 0.9217656850814819, 0.8300396203994751, 0.9267882704734802, 0.8571377992630005, 0.8949028253555298, 0.8637740015983582, 0.8700017333030701, 0.8559900522232056, 0.8446058034896851, 0.8296197652816772, 0.8693443536758423, 0.8392547369003296, 0.8580756783485413, 0.8868436217308044, 0.8558668494224548, 0.846125602722168], 'recall': [0.921088695526123, 0.8998717665672302, 0.883281409740448, 0.8696227073669434, 0.9048573970794678, 0.8788304328918457, 0.8644431829452515, 0.8961775898933411, 0.8862754106521606, 0.9116412401199341, 0.9254668354988098, 0.871403694152832, 0.902681827545166, 0.8288693428039551, 0.8484330177307129, 0.87548828125, 0.850525438785553, 0.8680712580680847, 0.9110621213912964, 0.858887255191803, 0.8701742887496948, 0.8521075248718262, 0.8616717457771301, 0.9006651043891907, 0.9243152737617493, 0.8648728132247925, 0.8954543471336365, 0.8616230487823486, 0.8943439722061157, 0.9214125871658325, 0.893877387046814, 0.8531697988510132, 0.9446707963943481, 0.875627875328064, 0.9420115947723389, 0.8940415382385254, 0.8893411159515381, 0.9030469655990601, 0.8806094527244568, 0.8540465831756592, 0.9350181818008423, 0.8330987691879272, 0.9084572792053223, 0.8994190692901611, 0.8502360582351685, 0.8657961487770081, 0.9553849697113037, 0.8483020663261414, 0.9155430793762207, 0.9206271767616272, 0.8398489952087402, 0.8974015712738037, 0.8924676775932312, 0.8800976276397705, 0.8516198992729187, 0.8846114873886108, 0.8766239881515503, 0.8807531595230103, 0.8929726481437683, 0.8670986890792847, 0.9029636383056641, 0.8509418964385986, 0.914048433303833, 0.8863567113876343, 0.9258047342300415, 0.9235333800315857, 0.8688050508499146, 0.9411224722862244, 0.9230420589447021, 0.8833457231521606, 0.8548015356063843, 0.9052037596702576, 0.9156610369682312, 0.837803304195404, 0.93858802318573, 0.8532683849334717, 0.8485407829284668, 0.903920590877533, 0.8772717118263245, 0.9164125323295593, 0.9416117072105408, 0.9073094725608826, 0.8770708441734314, 0.9743024110794067, 0.9070490002632141, 0.8379661440849304, 0.89863121509552, 0.9028739929199219, 0.8701714277267456, 0.8765882849693298, 0.8873845338821411, 0.9139918088912964, 0.8512430191040039, 0.8561817407608032, 0.9180812835693359, 0.8512241840362549, 0.8821180462837219, 0.8755566477775574, 0.8654441237449646, 0.8817931413650513], 'f1': [0.9076374173164368, 0.8852134346961975, 0.880057692527771, 0.8668283224105835, 0.9019081592559814, 0.8751780390739441, 0.862130343914032, 0.8960275053977966, 0.8829426169395447, 0.8885553479194641, 0.9170092344284058, 0.858466625213623, 0.8870738744735718, 0.8337801098823547, 0.8333321809768677, 0.8749359250068665, 0.8521000146865845, 0.8702744841575623, 0.9027420282363892, 0.8580706119537354, 0.8631035685539246, 0.8557838201522827, 0.8496869802474976, 0.8907020092010498, 0.9071874022483826, 0.8620975613594055, 0.8833532333374023, 0.8519140481948853, 0.8738732933998108, 0.8956746459007263, 0.8940918445587158, 0.8474228382110596, 0.8894405364990234, 0.8431023955345154, 0.9265896677970886, 0.9060960412025452, 0.874699592590332, 0.8856094479560852, 0.8814558386802673, 0.8456003665924072, 0.8955402970314026, 0.8303082585334778, 0.896404504776001, 0.8882286548614502, 0.8463777303695679, 0.8631216287612915, 0.9207313060760498, 0.8420965075492859, 0.903560996055603, 0.8940732479095459, 0.8334841728210449, 0.8816284537315369, 0.864285409450531, 0.8796532154083252, 0.8465846180915833, 0.8718141913414001, 0.8739069700241089, 0.8638761639595032, 0.895125150680542, 0.8528236746788025, 0.8970186710357666, 0.8435261249542236, 0.9101935029029846, 0.8757145404815674, 0.9279013276100159, 0.9044345617294312, 0.8582930564880371, 0.9061565399169922, 0.9152725338935852, 0.8768936395645142, 0.8582571744918823, 0.8790929913520813, 0.9012270569801331, 0.8365029096603394, 0.9283301830291748, 0.8596813678741455, 0.8350870013237, 0.9012101292610168, 0.8681968450546265, 0.8991097807884216, 0.9360828995704651, 0.9000816345214844, 0.8728261590003967, 0.9354807734489441, 0.9143480658531189, 0.8339840769767761, 0.912492573261261, 0.8794116973876953, 0.8823639154434204, 0.8701339960098267, 0.8786071538925171, 0.8840405941009521, 0.8479114770889282, 0.8426914811134338, 0.8930484056472778, 0.8451970815658569, 0.8699307441711426, 0.8811639547348022, 0.8606288433074951, 0.8635912537574768], 'hashcode': 'roberta-large_L17_no-idf_version=0.3.12(hug_trans=4.52.3)'}


Comparison for bart-large:
Pretrained Results:
  rouge: {'rouge1': np.float64(0.2607), 'rouge2': np.float64(0.1135), 'rougeL': np.float64(0.1835), 'rougeLsum': np.float64(0.2131)}
  bertscore: {'precision': [0.855510950088501, 0.849046528339386, 0.826606810092926, 0.8441917896270752, 0.8707363605499268, 0.824783205986023, 0.858435869216919, 0.8381650447845459, 0.8112742900848389, 0.8339812755584717, 0.8597059845924377, 0.8428727388381958, 0.8285530209541321, 0.8216572403907776, 0.8048869371414185, 0.8427119255065918, 0.8053833246231079, 0.8481019735336304, 0.8374717235565186, 0.8256361484527588, 0.8282281756401062, 0.8455384969711304, 0.8237589597702026, 0.8321097493171692, 0.8447701930999756, 0.8279864192008972, 0.8267775774002075, 0.8313596248626709, 0.8218474388122559, 0.837062418460846, 0.8821925520896912, 0.8142305612564087, 0.8217654228210449, 0.8198245763778687, 0.8225358724594116, 0.8535706996917725, 0.8314323425292969, 0.8554017543792725, 0.8281394243240356, 0.8152623176574707, 0.8113350868225098, 0.8206177353858948, 0.832122266292572, 0.8523454666137695, 0.8367702960968018, 0.8167335987091064, 0.82962965965271, 0.827165961265564, 0.8390974998474121, 0.8429791927337646, 0.8248315453529358, 0.8444675207138062, 0.8482138514518738, 0.8517866134643555, 0.8183902502059937, 0.8553388118743896, 0.8374782204627991, 0.8365036249160767, 0.8512831330299377, 0.8407189846038818, 0.8638083934783936, 0.8149501085281372, 0.8581452965736389, 0.8356807231903076, 0.8538299202919006, 0.8432403802871704, 0.8173888325691223, 0.8413587808609009, 0.8471431732177734, 0.8376662731170654, 0.853874683380127, 0.8366767764091492, 0.8441967964172363, 0.8129923343658447, 0.8507606387138367, 0.823049783706665, 0.8149199485778809, 0.84958815574646, 0.6950262784957886, 0.8248751163482666, 0.8083676099777222, 0.8273642063140869, 0.8425762057304382, 0.8487038612365723, 0.8696799278259277, 0.8367853760719299, 0.855674684047699, 0.8252023458480835, 0.8434831500053406, 0.7964935302734375, 0.816400408744812, 0.8114166259765625, 0.8141731023788452, 0.8289222717285156, 0.8280013799667358, 0.8286141157150269, 0.8338260650634766, 0.835832417011261, 0.81241774559021, 0.8287472724914551], 'recall': [0.8963024616241455, 0.8934204578399658, 0.8546302914619446, 0.8820139765739441, 0.9148804545402527, 0.8799389600753784, 0.900161862373352, 0.8857916593551636, 0.8626375794410706, 0.8953016996383667, 0.9169882535934448, 0.8965308666229248, 0.8760637044906616, 0.8436965942382812, 0.8588235378265381, 0.8709074258804321, 0.8114936351776123, 0.8530746102333069, 0.8860770463943481, 0.872792661190033, 0.8628033399581909, 0.867263913154602, 0.8600440621376038, 0.8973089456558228, 0.8905776739120483, 0.8703625798225403, 0.8825348615646362, 0.8998010158538818, 0.8916354179382324, 0.9017792344093323, 0.9154661297798157, 0.8433194756507874, 0.9171037077903748, 0.8913488388061523, 0.8786224722862244, 0.8985486030578613, 0.8845599889755249, 0.8894323110580444, 0.8615236282348633, 0.8732959032058716, 0.8963090181350708, 0.8414319753646851, 0.91768878698349, 0.9020383358001709, 0.8994300365447998, 0.873361349105835, 0.9159234166145325, 0.8434112071990967, 0.8578206896781921, 0.9254103899002075, 0.8503255248069763, 0.8803006410598755, 0.8968881368637085, 0.9014751315116882, 0.8818603157997131, 0.8946539759635925, 0.8673055768013, 0.8844135999679565, 0.8872812390327454, 0.9071331024169922, 0.9164460897445679, 0.8352482318878174, 0.906525194644928, 0.8846265077590942, 0.8944095373153687, 0.8967083692550659, 0.8465277552604675, 0.9081363081932068, 0.8851754069328308, 0.8879882097244263, 0.9153472185134888, 0.8958735466003418, 0.9017754793167114, 0.8298601508140564, 0.9240726828575134, 0.8437973260879517, 0.8551009297370911, 0.8762487769126892, 0.7920947074890137, 0.8941769599914551, 0.8329663276672363, 0.8409411311149597, 0.8688042163848877, 0.9360353946685791, 0.9172701835632324, 0.8588593006134033, 0.8957312703132629, 0.882890522480011, 0.9025222063064575, 0.85873943567276, 0.8770802021026611, 0.8869893550872803, 0.8369350433349609, 0.8970335721969604, 0.89574134349823, 0.8662054538726807, 0.8787342309951782, 0.8828778266906738, 0.8473109602928162, 0.8533447980880737], 'f1': [0.8754317760467529, 0.8706684708595276, 0.8403849601745605, 0.8626885414123535, 0.8922626972198486, 0.8514688014984131, 0.8788038492202759, 0.8613204956054688, 0.8361679911613464, 0.8635542988777161, 0.8874236345291138, 0.868874192237854, 0.8516462445259094, 0.8325311541557312, 0.8309809565544128, 0.8565777540206909, 0.8084269165992737, 0.8505809903144836, 0.8610890507698059, 0.8485597372055054, 0.8451623320579529, 0.8562634587287903, 0.8415104746818542, 0.8634803295135498, 0.8670693635940552, 0.8486458659172058, 0.8537468314170837, 0.8642274141311646, 0.8553202152252197, 0.8682165145874023, 0.8985214233398438, 0.8285197019577026, 0.8668209314346313, 0.8540918827056885, 0.8496546149253845, 0.8754823207855225, 0.8571737408638, 0.8720851540565491, 0.8445017337799072, 0.8432818651199341, 0.8517078757286072, 0.8308944702148438, 0.8728134036064148, 0.8764881491661072, 0.8669694662094116, 0.8440988063812256, 0.8706434965133667, 0.8352095484733582, 0.8483557105064392, 0.8822736144065857, 0.8373845219612122, 0.8620118498802185, 0.8718721866607666, 0.8759267330169678, 0.8489406108856201, 0.8745547533035278, 0.8521309494972229, 0.8597916960716248, 0.8689095377922058, 0.872664213180542, 0.889349102973938, 0.8249743580818176, 0.8816720247268677, 0.8594573140144348, 0.8736487030982971, 0.869152843952179, 0.8317031264305115, 0.8734731674194336, 0.8657417893409729, 0.8620935082435608, 0.8835430145263672, 0.865263819694519, 0.8720366954803467, 0.8213396072387695, 0.8859025239944458, 0.8332944512367249, 0.8345270752906799, 0.8627125024795532, 0.7403925061225891, 0.8581291437149048, 0.8204826712608337, 0.8340973854064941, 0.8554892539978027, 0.8902329206466675, 0.8928413391113281, 0.8476787209510803, 0.8752449154853821, 0.8530722260475159, 0.8720045685768127, 0.8264461159706116, 0.845653235912323, 0.8475216627120972, 0.8253971934318542, 0.8616339564323425, 0.8605403304100037, 0.8469929099082947, 0.8556913137435913, 0.858711302280426, 0.8294975161552429, 0.840866208076477], 'hashcode': 'roberta-large_L17_no-idf_version=0.3.12(hug_trans=4.52.3)'}
Fine-tuned Results:
  rouge: {'rouge1': np.float64(0.321), 'rouge2': np.float64(0.135), 'rougeL': np.float64(0.2309), 'rougeLsum': np.float64(0.2901)}
  bertscore: {'precision': [0.8248820304870605, 0.8684781789779663, 0.9405921101570129, 0.858653724193573, 0.9022374153137207, 0.8588167428970337, 0.8242461681365967, 0.8705801963806152, 0.8370225429534912, 0.892269492149353, 0.8853975534439087, 0.8808315992355347, 0.848433256149292, 0.8324947357177734, 0.8351260423660278, 0.8611099123954773, 0.8629383444786072, 0.9060975313186646, 0.88555908203125, 0.8408710360527039, 0.8300031423568726, 0.846317708492279, 0.8366190791130066, 0.8780067563056946, 0.8746613264083862, 0.8196520209312439, 0.8558437824249268, 0.8162545561790466, 0.8743768930435181, 0.8857426047325134, 0.8740040063858032, 0.8104414939880371, 0.8830763101577759, 0.8564786314964294, 0.896957516670227, 0.845238208770752, 0.8245849013328552, 0.8450584411621094, 0.8727977275848389, 0.8349429965019226, 0.8649405837059021, 0.815889835357666, 0.8713377714157104, 0.8986146450042725, 0.8221579790115356, 0.8535677194595337, 0.8849343061447144, 0.8420572876930237, 0.8862498998641968, 0.8262875080108643, 0.8307188749313354, 0.826683521270752, 0.8756232261657715, 0.8547857999801636, 0.8537227511405945, 0.9168500304222107, 0.8693832159042358, 0.8354548215866089, 0.8616119027137756, 0.8448854684829712, 0.8697565793991089, 0.8435720205307007, 0.8885371088981628, 0.8764410018920898, 0.8795775175094604, 0.8928877711296082, 0.8618363738059998, 0.8891966342926025, 0.8778164982795715, 0.871745228767395, 0.8649880290031433, 0.8408747315406799, 0.8822202682495117, 0.8122342824935913, 0.8745213747024536, 0.8386198282241821, 0.8378177881240845, 0.8586573600769043, 0.8547018766403198, 0.884875476360321, 0.8090606927871704, 0.8569545149803162, 0.8448671102523804, 0.8697563409805298, 0.8917425870895386, 0.8371734619140625, 0.9269440174102783, 0.8294754028320312, 0.8627911806106567, 0.8483004570007324, 0.8906357288360596, 0.8191739320755005, 0.8746627569198608, 0.8332740068435669, 0.8629747629165649, 0.8536704778671265, 0.8352794647216797, 0.8813775777816772, 0.8908235430717468, 0.8425867557525635], 'recall': [0.851942241191864, 0.9191781878471375, 0.9507031440734863, 0.9042758345603943, 0.9001607894897461, 0.8820167183876038, 0.8548232913017273, 0.8913947343826294, 0.8982139825820923, 0.947271466255188, 0.9238905906677246, 0.8843709826469421, 0.9019695520401001, 0.8520936965942383, 0.8686107397079468, 0.8687300682067871, 0.8746389150619507, 0.8962801694869995, 0.9155916571617126, 0.8866653442382812, 0.8464663624763489, 0.8603837490081787, 0.8696454167366028, 0.9166221618652344, 0.9130918979644775, 0.8543757200241089, 0.8891876935958862, 0.8452401161193848, 0.9000873565673828, 0.9211093187332153, 0.9227861166000366, 0.8292154669761658, 0.943101704120636, 0.895632803440094, 0.9300925135612488, 0.8784918189048767, 0.8826168775558472, 0.8768267035484314, 0.8706809878349304, 0.8826592564582825, 0.9016929864883423, 0.8461194634437561, 0.9311920404434204, 0.9117603898048401, 0.8758076429367065, 0.861343264579773, 0.9515320062637329, 0.8487783670425415, 0.8796968460083008, 0.838969349861145, 0.8474674224853516, 0.8820549845695496, 0.9198984503746033, 0.8631142377853394, 0.855044960975647, 0.9208196401596069, 0.8841489553451538, 0.8580787777900696, 0.8961718678474426, 0.8958115577697754, 0.9055824875831604, 0.8623413443565369, 0.9242795705795288, 0.9027204513549805, 0.9352312088012695, 0.9084386229515076, 0.8882618546485901, 0.9346418380737305, 0.872374951839447, 0.8903020620346069, 0.8505889177322388, 0.9121809005737305, 0.9120985269546509, 0.8305126428604126, 0.9391133189201355, 0.8543444871902466, 0.8518341183662415, 0.8713681697845459, 0.8721912503242493, 0.9212322235107422, 0.8346500396728516, 0.85423743724823, 0.8638015985488892, 0.913256049156189, 0.9119137525558472, 0.8490129709243774, 0.8959356546401978, 0.8926101922988892, 0.9181352853775024, 0.875629186630249, 0.9148433208465576, 0.8834762573242188, 0.8675374984741211, 0.8976943492889404, 0.8946524262428284, 0.840430736541748, 0.8982068300247192, 0.9074305295944214, 0.8960511088371277, 0.8815244436264038], 'f1': [0.8381937742233276, 0.8931092619895935, 0.945620596408844, 0.8808744549751282, 0.9011979103088379, 0.8702621459960938, 0.8392562866210938, 0.8808645009994507, 0.8665392994880676, 0.918948233127594, 0.9042345881462097, 0.882597804069519, 0.8743826746940613, 0.8421801924705505, 0.8515393137931824, 0.8649032115936279, 0.8687492609024048, 0.9011621475219727, 0.9003249406814575, 0.8631612062454224, 0.8381538391113281, 0.85329270362854, 0.852812647819519, 0.8968990445137024, 0.8934635519981384, 0.8366537690162659, 0.872197151184082, 0.8304944634437561, 0.8870458602905273, 0.9030798673629761, 0.8977327942848206, 0.819720983505249, 0.9121025204658508, 0.8756182789802551, 0.9132245779037476, 0.8615442514419556, 0.8526145815849304, 0.8606495261192322, 0.871738076210022, 0.858138382434845, 0.8829345107078552, 0.8307297825813293, 0.9002711176872253, 0.9051398038864136, 0.848135232925415, 0.8574379086494446, 0.917025625705719, 0.8454044461250305, 0.8829612135887146, 0.8325801491737366, 0.8390095829963684, 0.853472113609314, 0.897214949131012, 0.8589298129081726, 0.8543834090232849, 0.9188306331634521, 0.8767039179801941, 0.8466156721115112, 0.8785521388053894, 0.8696035742759705, 0.8873080611228943, 0.8528534770011902, 0.9060559868812561, 0.8893866539001465, 0.9065510034561157, 0.9005960822105408, 0.8748496174812317, 0.9113530516624451, 0.8750872611999512, 0.8809258937835693, 0.8577280640602112, 0.8750776648521423, 0.8969106674194336, 0.8212717771530151, 0.9056671857833862, 0.8464091420173645, 0.8447677493095398, 0.8649660348892212, 0.8633579611778259, 0.9026879072189331, 0.8216561675071716, 0.8555938005447388, 0.8542294502258301, 0.8909755349159241, 0.9017153382301331, 0.8430516719818115, 0.9111760854721069, 0.8598855137825012, 0.889603316783905, 0.861748218536377, 0.9025772213935852, 0.8501108884811401, 0.871085524559021, 0.864285409450531, 0.8785281181335449, 0.8469988703727722, 0.8656010031700134, 0.894214391708374, 0.893429696559906, 0.8616159558296204], 'hashcode': 'roberta-large_L17_no-idf_version=0.3.12(hug_trans=4.52.3)'}
"""